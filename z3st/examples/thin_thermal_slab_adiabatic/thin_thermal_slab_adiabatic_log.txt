Info    : Reading 'mesh.msh'...
Info    : 27 entities
Info    : 27900 nodes
Info    : 30392 elements
Info    : Done reading 'mesh.msh'

--.. ..- .-.. .-.. --- --.. ..- .-.. .-.. --- --.. ..- .-.. .-.. ---
Z3ST: An open-source FEniCSx framework for thermo-mechanical analysis
Author: Giovanni Zullo
Version: 0.1.0 (2025)
--.. ..- .-.. .-.. --- --.. ..- .-.. .-.. --- --.. ..- .-.. .-.. ---

[DESCRIPTION]
Z3ST is an open-source framework for the thermo-mechanical modelling
of materials and multi-material domains. Built on FEniCSx, it supports
transient simulations, complex geometries, and user-defined boundary
conditions.

__Config initializer__
  → Geometry            : geometry.yaml
  → Mesh                : mesh.msh
  → Boundary conditions : boundary_conditions.yaml
  → Time steps          : 1
  → Models active       :
      thermal    → ON
      mechanical → ON
  → Gap conductance     : None (value = 0.0)


__FiniteElementSetup initializer__
Mechanical function space (V_m): FunctionSpace(<Mesh #0>, blocked element (Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, []), (3,)))
Thermal function space (V_t): FunctionSpace(<Mesh #0>, Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, []))
Scalar function space (Q): FunctionSpace(<Mesh #0>, Basix element (P, hexahedron, 0, gll_warped, unset, True, float64, []))
[Solver] initializer
  Applied relaxation factor:
  → Temperature  : 0.9
  → Displacement : 0.7
  Adaptive relaxation enabled
  → relax_growth  : 1.2
  → relax_shrink : 0.8
  → relax_min  : 0.05
  → relax_max : 0.95


[ThermalModel] initializer
[ThermalModel] options loaded from input.yaml:
  solver              : linear
  linear_solver       : iterative_amg
  rtol                : 1e-06
  stag_tol            : 1e-06
  convergence         : rel_norm
[MechanicalModel] initializer
[MechanicalModel] options loaded from input.yaml:
  solver              : linear
  linear_solver       : iterative_amg
  rtol                : 1e-06
  stag_tol            : 1e-06
  mechanical_regime   : 3D
  convergence         : rel_norm
  debug               : False
[GapModel] initializer
[LOADING MATERIALS]
Steel material loaded:
  → k defined as constant: 48.1
  → constitutive model: lame
  E               → 177000000000.0 (float)
  G               → 68076923076.92307 (float)
  T_ref           → 300.0 (float)
  alpha           → 1.7e-05 (float)
  bulk_modulus    → 147499999999.99997 (float)
  constitutive_mode → lame (str)
  cp              → 200.0 (float)
  gamma_heating   → 2000000.0 (float)
  k               → 48.1 (float)
  lmbda           → 102115384615.38461 (float)
  mu_gamma        → 24.0 (float)
  name            → vessel_steel (str)
  nu              → 0.3 (float)
  rho             → 8000.0 (float)
[INITIALIZING FIELDS]
[UPDATING q_third]

Initializing the temperature field...
  → Setting initial temperature for material: 'steel'
    Set 27900 DOFs to 300.00 K
  Initial T: min=300.00 K, max=300.00 K, mean=300.00 K

Initializing the displacement field...
  Initial u: min=0.00e+00 m, max=0.00e+00 m, mean=0.00e+00 m
Initializing self.sol_mixed
Initialize with the current state (displacement and temperature fields)

Comparing solution function spaces:
  Displacement space (self.u):          blocked element (Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, []), (3,))
  Mixed-space displacement (W.sub(0)):  blocked element (Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, []), (3,))
  Temperature space (self.T):           Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, [])
  Mixed-space temperature (W.sub(1)):   Basix element (P, hexahedron, 1, gll_warped, unset, False, float64, [])
[SETTING BOUNDARY CONDITIONS]
Loading boundary conditions from 'boundary_conditions.yaml'

Setting thermal boundary conditions...
  [INFO] Dirichlet thermal BC on 'steel' → 490.0 K at region 'xmin'

Setting mechanical boundary conditions...
  [INFO] Clamp_x mechanical BC on 'steel' → Clamp_x at region 'xmin'
  [INFO] Clamp_y mechanical BC on 'steel' → Clamp_y at region 'ymin'
  [INFO] Clamp_z mechanical BC on 'steel' → u_z = 0.0 at region 'zmin'

[STEP 01/1] t = 0.00e+00 s | LHR = 0.00e+00 W/m
[UPDATING q_third]
Current step = 0

Solver settings:
  → Coupling : staggered
  → Max iterations              : 100
  → Staggering tolerance |ΔT|   : 1.0e-06
  → Staggering tolerance |Δu|   : 1.0e-06
  → Relative tolerance th       : 1.0e-06
  → Relative tolerance mech     : 1.0e-06

--- Staggering iteration 1/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 3.934e-01
  [adaptive] relax_T=0.90

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 1.000e+00
  [adaptive] relax_u=0.70

Convergence check

--- Staggering iteration 2/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 3.934e-02
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 4.000e-01
  [adaptive] relax_u=0.84

Convergence check

--- Staggering iteration 3/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 4.153e-03
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 1.567e-01
  [adaptive] relax_u=0.95

Convergence check

--- Staggering iteration 4/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 2.076e-04
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 2.907e-02
  [adaptive] relax_u=0.95

Convergence check

--- Staggering iteration 5/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 1.038e-05
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 1.489e-03
  [adaptive] relax_u=0.95

Convergence check

--- Staggering iteration 6/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 5.191e-07
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 7.625e-05
  [adaptive] relax_u=0.95

Convergence check

--- Staggering iteration 7/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 2.596e-08
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 3.902e-06
  [adaptive] relax_u=0.95

Convergence check

--- Staggering iteration 8/100 ---

[INFO] Assembling thermal problem...

  Building weak form, volume integrals (dx) for steel, tag = 7
  → q_third[steel](W/m3) min = 1.81e+05, max = 2.00e+06, mean = 1.17e+06
  Linear solver
  ||ΔT||/||T|| = 1.298e-09
  [adaptive] relax_T=0.95

[INFO] Assembling mechanical problem...
  Building weak form, volume integrals (dx) for steel, tag = 7
  Linear solver
  ||Δu||/||u|| = 1.996e-07
  [adaptive] relax_u=0.95

Convergence check

[SUCCESS] Staggered solver converged in 8 iterations.
Computing symbolic result fields (strain, stress, ...)
Exporting results to VTU file...
  → Projecting stress and heat flux for all materials...
VTU file exported to: output/fields.vtu

Simulation completed in 71.18 s
Total time steps solved: 1
